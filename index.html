<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prakash Travels | Scorpio Premium</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #ff4e00; --accent: #ff8c00; --dark: #121212; --success: #25d366; }
        body { 
            font-family: 'Poppins', sans-serif; margin: 0; 
            background: linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.65)), url('https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&w=1920&q=80');
            background-size: cover; background-attachment: fixed; background-position: center; color: #333;
        }
        .logo-box { width: 75px; height: 75px; background: white; margin: 20px auto; border-radius: 20px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(0,0,0,0.5); border: 2px solid var(--primary); }
        header { text-align: center; color: white; padding: 10px; }
        header h1 { margin: 0; font-size: 30px; letter-spacing: 2px; text-shadow: 2px 2px 8px rgba(0,0,0,0.7); }
        header h3 { margin: 5px; font-size: 14px; opacity: 0.9; }
        nav { display: flex; justify-content: center; gap: 10px; padding: 10px; position: sticky; top: 0; z-index: 100; }
        nav a { background: white; padding: 10px 15px; border-radius: 50px; text-decoration: none; font-size: 13px; font-weight: 700; color: var(--dark); cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .section { display: none; padding: 20px 15px; max-width: 450px; margin: auto; animation: fadeIn 0.4s; }
        .active { display: block; }
        .card { background: rgba(255, 255, 255, 0.98); padding: 25px; border-radius: 25px; box-shadow: 0 25px 50px rgba(0,0,0,0.6); }
        input, button { width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; border: 1px solid #ddd; box-sizing: border-box; font-size: 15px; }
        button { background: linear-gradient(90deg, var(--primary), var(--accent)); color: white; border: none; font-weight: bold; cursor: pointer; }
        .booking-item { background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 8px solid var(--primary); box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <div class="logo-box">
        <svg width="45" height="45" viewBox="0 0 24 24" fill="#ff4e00"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5H6.5C5.84 5 5.28 5.42 5.08 6.01L3 12V20C3 20.55 3.45 21 4 21H5C5.55 21 6 20.55 6 20V19H18V20C18 20.55 18.45 21 19 21H20C20.55 21 21 20.55 21 20V12L18.92 6.01ZM6.5 7H17.5L18.83 11H5.17L6.5 7ZM19 17H5V13H19V17Z"/></svg>
    </div>
    <h1>SAFE RIDE</h1>
    <h3>Authorised By :- PRAKASH TRAVELS</h3>
</header>

<nav>
    <a onclick="show('book')">BOOKING</a>
    <a onclick="show('history')">HISTORY</a>
    <a onclick="show('admin')">OWNER</a>
</nav>

<div id="book" class="section active">
    <div class="card">
        <h3 style="text-align:center; color:var(--primary); margin:0;">Confirm Scorpio Ride</h3>
        <input type="text" id="b-name" placeholder="Full Name">
        <input type="number" id="b-contact" placeholder="Mobile Number">
        <input type="text" id="b-from" placeholder="Pick-up City">
        <input type="text" id="b-to" placeholder="Drop City">
        <div style="display:flex; gap:10px;">
            <input type="number" id="b-km" placeholder="KM">
            <input type="number" id="b-days" placeholder="Days">
        </div>
        <input type="date" id="b-date">
        <button onclick="handleBooking()">BOOK NOW & SEND WHATSAPP</button>
    </div>
</div>

<div id="history" class="section">
    <div class="card">
        <h3>My Trips</h3>
        <input type="number" id="search-id" placeholder="Enter Mobile Number">
        <button onclick="customerSearch()">SEARCH</button>
        <div id="status-area" style="margin-top:15px;"></div>
    </div>
</div>

<div id="admin" class="section">
    <div class="card" id="admin-login-box">
        <h3>Owner Dashboard</h3>
        <input type="number" id="o-mobile" placeholder="Mobile Number">
        <input type="password" id="o-pass" placeholder="Password">
        <button onclick="ownerLogin()">LOGIN</button>
    </div>
    <div id="admin-panel" style="display:none;">
        <h3 style="color:var(--primary)">All Bookings</h3>
        <div id="admin-list"></div>
        <button onclick="location.reload()" style="background:#444;">LOGOUT</button>
    </div>
</div>

<script>
    // --- Local Database (Backup) ---
    let localDB = JSON.parse(localStorage.getItem('prakash_backups')) || [];

    // --- Firebase Configuration ---
    const firebaseConfig = {
        apiKey: "AIzaSy...", // Aap apni real keys yahan paste kar sakte hain
        authDomain: "your-app.firebaseapp.com",
        projectId: "your-project-id",
        storageBucket: "your-app.appspot.com",
        messagingSenderId: "12345",
        appId: "1:12345"
    };

    let db = null;
    try {
        if(firebaseConfig.apiKey !== "AIzaSy...") {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
        }
    } catch(e) { console.log("Firebase not ready."); }

    const OWNER_WA = "917294949606";
    const ADMIN_MOB = "7250824448";
    const ADMIN_PASS = "Pranav123";

    function show(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    async function handleBooking() {
        const name = document.getElementById('b-name').value;
        const contact = document.getElementById('b-contact').value;
        const from = document.getElementById('b-from').value;
        const to = document.getElementById('b-to').value;
        const km = document.getElementById('b-km').value;
        const days = document.getElementById('b-days').value || 1;
        const date = document.getElementById('b-date').value;

        if(!name || !contact || !from) return alert("Kripya saari details bhariye!");

        const bookingData = { name, contact, from, to, km, days, date, timestamp: new Date().toISOString() };

        // 1. Save to Local Backup (Always works!)
        localDB.push(bookingData);
        localStorage.setItem('prakash_backups', JSON.stringify(localDB));

        // 2. WhatsApp Message
        const message = `*âœ¨ PRAKASH TRAVELS - NEW BOOKING âœ¨*%0A----------------------------------%0AðŸ‘¤ *Customer:* ${name}%0AðŸ“ *Route:* ${from} to ${to}%0AðŸ›£ï¸ *KM:* ${km} | *Days:* ${days}%0AðŸ“… *Date:* ${date}%0AðŸ“ž *Contact:* ${contact}%0A----------------------------------%0A_âœ… Sent via Scorpio Web_`;

        window.open(`https://wa.me/${OWNER_WA}?text=${message}`, '_blank');

        // 3. Cloud Save (Optional)
        if(db) {
            try { await db.collection("bookings").add(bookingData); } catch(e) { console.log("Cloud skip."); }
        }

        alert("Booking Successful! Details WhatsApp par bhej di gayi hain.");
        show('history');
        customerSearch(contact);
    }

    function customerSearch(preFill = null) {
        const id = preFill || document.getElementById('search-id').value;
        const trips = localDB.filter(t => t.contact === id);
        document.getElementById('status-area').innerHTML = trips.length > 0 ? trips.map(t => `
            <div class="booking-item">
                <b>${t.from} âž” ${t.to}</b><br><small>${t.date} | ${t.days} Days</small>
            </div>
        `).join('') : "<p style='color:red;'>Koi booking nahi mili.</p>";
    }

    function ownerLogin() {
        const m = document.getElementById('o-mobile').value;
        const p = document.getElementById('o-pass').value;
        if(m === ADMIN_MOB && p === ADMIN_PASS) {
            document.getElementById('admin-login-box').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'block';
            loadAdminData();
        } else { alert("Galat ID ya Password!"); }
    }

    function loadAdminData() {
        const list = document.getElementById('admin-list');
        list.innerHTML = localDB.length > 0 ? localDB.reverse().map((b, i) => `
            <div class="booking-item">
                <b>${b.name}</b> (${b.contact})<br>${b.from} to ${b.to}<br>
                <a href="tel:${b.contact}" style="color:green; text-decoration:none; font-weight:bold;">ðŸ“ž Call Customer</a>
            </div>
        `).join('') : "No bookings yet.";
    }
</script>
</body>

</html>
